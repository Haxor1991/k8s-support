apiVersion: extensions/v1beta1
kind: DaemonSet
metadata:
  name: ndt-cloud-index1
  namespace: default
spec:
  selector:
    matchLabels:
      run: ndt-cloud
  template:
    metadata:
      labels:
        run: ndt-cloud
      annotations:
        prometheus.io/scrape: 'true'
    spec:
      nodeSelector:
        mlab/type: 'platform'
      containers:
        - name: ndt-cloud
          image: measurementlab/ndt-cloud:v0.1
          ports:
          - containerPort: 3010
          - containerPort: 9090
          volumeMounts:
          - name: ndt-certificates
            mountPath: /certs
            readOnly: true
      volumes:
      - name: ndt-certificates
        secret:
          secretName: ndt-certificates
