This repo contains all of the scripts and configs required to set up the
world-spanning M-Lab kubernetes (k8s) cluster.  The organization is as follows:
- [cloud/](cloud/) contains all the scripts necessary to set up and configure
  the cloud master node(s) as well as new nodes in Google cloud for monitoring
  services and the like.
- [network/](network/) contains files required for setting up the cluster
  network. These configs should be first applied very early on in the cluster
  setup process.
- [node/](node/) contains files to set up platform nodes and have them join the
  cluster.
- [services/](services/) contains files required for internal services on the
  platform (the node exporter, monitoring, etc).  These services should be
  deployed after the master is set up and before any experiments are deployed.

Once all of the above systems are working well:
- [experiments/](experiments/) contains config files for each experiment
  deployed on the platform.

# Kubernetes (k8s) architecture

In order to run, k8s needs:
1. A subnet
2. A VPN on that subnet that can be joined by both GCE and non-GCE machines
3. 3 distinct `etcd` instances running on different machines, all mutually backing each other up
4. An instance of `kube-apiserver`
5. An instance of `kube-controller-manager`
6. An instance of `kube-scheduler`
7. An instance of `kube-dns` (optional but very handy)
8. A certificate authority for generating certs

Each machine that wants to be controlled by k8s (each Node) needs:
1. Appropriate certs, generated by the CA on the root server
2. a VPN client connected to the VPN
3. To run `kubelet` to connect to the controller
4. To run `kube-proxy` (maybe, hopefully not required)
5. To install `cri-containerd` to respond appropriately to commands to run a
   container
6. To install CNI and any relevant plugins to allocate IPs to containers
   appropriately
